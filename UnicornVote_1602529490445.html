<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>UnicornVote</title>
    
    <style type="text/css">
    button {
  background-color: #000;
  color: #fff;
  border: 0;
  font-size: 1em;
}

    </style>
  </head>
  <body>
    <div class="container">
    <br/>
    <label id="question"></label><br>
    <button id="yeah">Yeah</button>
    <button id="nay">Nay</button>
    <br/>
    <label id="result">Result:</label>
</diV>


    <script type="text/javascript">
    window.BuidlProviders = {
      web3: {
        url: "https://rpc.oasiseth.org:8545",
        chainId: "69",
        gasPrice: "1",
        gasLimit: "8000000",
      },
      es: {
        url: "https://devchain.ss.search.secondstate.io"
      }
    }
    </script>
    <script type="text/javascript" src="https://buidl.secondstate.io/embed/main.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script type="text/javascript">
    /* Don't modify */
var abi = [{"constant":false,"inputs":[],"name":"withdraw","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getAddrs","outputs":[{"name":"","type":"address[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"question","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_price","type":"uint256"}],"name":"setPrice","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"price","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"yeah","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":true,"inputs":[],"name":"winner","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"nay","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"inputs":[{"name":"_question","type":"string"},{"name":"_price","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"}];
var bytecode = '6060604052341561000f57600080fd5b604051610adb380380610adb83398101604052808051820191906020018051906020019091905050336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060006002819055506000600381905550816001908051906020019061009d9291906100ac565b50806004819055505050610151565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106100ed57805160ff191683800117855561011b565b8280016001018555821561011b579182015b8281111561011a5782518255916020019190600101906100ff565b5b509050610128919061012c565b5090565b61014e91905b8082111561014a576000816000905550600101610132565b5090565b90565b61097b806101606000396000f30060606040526004361061008e576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680633ccfd60b146100935780633f416eb3146100a85780633fad9ae01461011257806391b7f5ed146101a0578063a035b1fe146101c3578063a92d0989146101ec578063dfbf53ae146101f6578063ea2fe1a214610284575b600080fd5b341561009e57600080fd5b6100a661028e565b005b34156100b357600080fd5b6100bb610363565b6040518080602001828103825283818151815260200191508051906020019060200280838360005b838110156100fe5780820151818401526020810190506100e3565b505050509050019250505060405180910390f35b341561011d57600080fd5b6101256103f7565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561016557808201518184015260208101905061014a565b50505050905090810190601f1680156101925780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101ab57600080fd5b6101c16004808035906020019091905050610495565b005b34156101ce57600080fd5b6101d66104fa565b6040518082815260200191505060405180910390f35b6101f4610500565b005b341561020157600080fd5b610209610680565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561024957808201518184015260208101905061022e565b50505050905090810190601f1680156102765780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b61028c610756565b005b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156102e957600080fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc3073ffffffffffffffffffffffffffffffffffffffff16319081150290604051600060405180830381858888f19350505050151561036157600080fd5b565b61036b6108d6565b60068054806020026020016040519081016040528092919081815260200182805480156103ed57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190600101908083116103a3575b5050505050905090565b60018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561048d5780601f106104625761010080835404028352916020019161048d565b820191906000526020600020905b81548152906001019060200180831161047057829003601f168201915b505050505081565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156104f057600080fd5b8060048190555050565b60045481565b600454341015151561051157600080fd5b600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160019054906101000a900460ff1615151561056d57600080fd5b60016002600082825401925050819055506006805480600101828161059291906108ea565b9160005260206000209001600033909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050604080519081016040528060011515815260200160011515815250600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548160ff02191690831515021790555060208201518160000160016101000a81548160ff021916908315150217905550905050565b610688610916565b60035460025414156106d1576040805190810160405280600481526020017f64726177000000000000000000000000000000000000000000000000000000008152509050610753565b600354600254111561071a576040805190810160405280600481526020017f79656168000000000000000000000000000000000000000000000000000000008152509050610753565b6040805190810160405280600381526020017f6e6179000000000000000000000000000000000000000000000000000000000081525090505b90565b600454341015151561076757600080fd5b600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160019054906101000a900460ff161515156107c357600080fd5b6001600360008282540192505081905550600680548060010182816107e891906108ea565b9160005260206000209001600033909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050604080519081016040528060001515815260200160011515815250600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548160ff02191690831515021790555060208201518160000160016101000a81548160ff021916908315150217905550905050565b602060405190810160405280600081525090565b81548183558181151161091157818360005260206000209182019101610910919061092a565b5b505050565b602060405190810160405280600081525090565b61094c91905b80821115610948576000816000905550600101610930565b5090565b905600a165627a7a72305820bc2d6d0173d3d9379eee9f1a755731c2d0cdf32b2fd9f318d39e03695dfe488f0029';
var cAddr = '0xd6a5f2d4ac2f654a3e2171ede567f76b2b7bf022';
/* Don't modify */

var instance = null;
window.addEventListener('web3Ready', function() {
  var contract = web3.ss.contract(abi);
  instance = contract.at(cAddr);
  reload();
});

var price = "0"; // This is in the unit of OETH. e.g., 0.01

function reload() {
  instance.question(function (e, r) {
     $("#question").text(r);
  });
  instance.winner(function (e, r) {
     $("#result").text("Result: " + r);
  });
}

$("#yeah").click(function() {
    web3.ss.getAccounts(function (e, address) {
        if (!e) {
            instance.yeah({
                value: price,
                gas: 499000,
                gasPrice: 1
            }, function (ee, r) {
                if (ee) {
                    window.alert("You need to pay " + price + " OETH to vote. Make sure that you have it in your address.");
                }
            });
            setTimeout(function () {
                reload ();
            }, 10 * 1000);
        }
    });
    return false;
});

$("#nay").click(function() {
    web3.ss.getAccounts(function (e, address) {
        if (!e) {
            instance.nay({
                value: price,
                gas: 499000,
                gasPrice: 1
            }, function (ee, r) {
                if (ee) {
                    window.alert("You need to pay " + price + " OETH to vote. Make sure that you have it in your address.");
                }
            });
            setTimeout(function () {
                reload ();
            }, 10 * 1000);
        }
    });
    return false;
});
    </script>
  </body>
</html>